<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>M√©todos de pago ‚Äî Finanzas</title>
  <link rel="stylesheet" href="/css/styles.css"/>
</head>
<body>
<header>
  <div><a href="/dashboard.html">üí∏ Finanzas ‚Äî  M√©todos de pago</a></div>
  <div class="nav">
    <a href="/categories.html">Categor√≠as</a>
    <a href="/payment-methods.html">M√©todos de pago</a>
    <a href="/transactions.html">Transacciones</a>
    <a href="/budgets.html">Presupuestos</a>
    <a href="/reports.html">Reportes</a>
    <button onclick="logout()">Salir</button>
  </div>
</header>

<div class="container">
  <h1>M√©todos de pago</h1>

  <div class="grid">
    <!-- Formulario -->
    <div class="card">
      <h2>Nuevo m√©todo</h2>
      <label>Nombre</label>
      <input id="pmNombre" />
      <br/>
      <button class="primary" onclick="crear()">Crear</button>
      <div id="msg" class="toast"></div>
    </div>

    <!-- Listado -->
    <div class="card">
      <h2>Listado</h2>
      <table id="tabla">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Activo</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal edici√≥n PM -->
<div id="pmModalOv" class="modal-overlay">
  <div class="modal">
    <header>
      <h2>Editar m√©todo de pago</h2>
      <button onclick="closePm()">‚úñ</button>
    </header>
    <div>
      <label>Nombre</label>
      <input id="pmEditNombre" />
      <label class="toggle"><input type="checkbox" id="pmEditActivo"/> Activo</label>
      <div id="pmEditMsg" class="toast"></div>
    </div>
    <div class="actions">
      <button class="secondary" onclick="closePm()">Cancelar</button>
      <button class="primary" onclick="guardarPm()">Guardar cambios</button>
    </div>
  </div>
</div>
<!-- Modal eliminaci√≥n / archivado de M√©todo de pago -->
<div id="pmDelOv" class="modal-overlay">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="pmDelTitle">
    <header>
      <h2 id="pmDelTitle">Eliminar m√©todo de pago</h2>
      <button onclick="pmCloseDel()" aria-label="Cerrar">‚úñ</button>
    </header>

    <div>
      <p style="margin-bottom:10px">
        <strong id="pmDelName">‚Äî</strong>
      </p>

      <div id="pmDelCounts" class="toast">
        <p style="margin:0">
          Este m√©todo tiene <strong id="pmDelTxs">0</strong> transacciones asociadas.
        </p>
      </div>

      <div class="toast" style="margin-top:8px">
        <p style="margin:0 0 6px">¬øQu√© deseas hacer?</p>
        <ul style="margin-left:18px; color:#4B5563">
          <li><strong>Eliminar TODO (cascada)</strong>: borra transacciones + el m√©todo.</li>
          <li><strong>Archivar</strong>: marca el m√©todo como inactivo y mantiene el historial.</li>
          <li><strong>Cancelar</strong>: no se realiza ning√∫n cambio.</li>
        </ul>
      </div>

      <div id="pmDelNoteNoUse" class="toast hidden" style="margin-top:8px">
        <small class="muted">Este m√©todo no tiene transacciones. Puedes eliminarlo directamente o archivarlo si prefieres.</small>
      </div>

      <div id="pmDelMsg" class="toast" style="display:none"></div>
    </div>

    <div class="actions">
      <button class="secondary" onclick="pmCloseDel()">Cancelar</button>
      <button class="secondary" id="pmBtnArchive" onclick="pmDoArchive()">Archivar (mantener historial)</button>
      <button class="primary"   id="pmBtnCascade" onclick="pmDoCascade()">Eliminar TODO (cascada)</button>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="/js/ui.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/api.js"></script>
<script src="/js/common.js"></script>

</body>
</html>
